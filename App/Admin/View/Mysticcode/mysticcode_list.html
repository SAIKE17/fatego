<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>礼装列表</title>
        <link href="__HOME__/css/bootstrap.min.css" rel="stylesheet">
        <link href="__HOME__/css/font-awesome.min.css" rel="stylesheet">        
        <link href="__HOME__/css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
        <link href="__HOME__/css/animate.min.css" rel="stylesheet">
        <link href="__HOME__/css/style.min.css" rel="stylesheet">
    </head>
    <body>
        <div class="animated fadeInRight">
            <div class="float-e-margins">
                <div class="col-sm-12">
                    <!--工具栏-->
                    <div class="ibox-title" style="border-top: 1px solid #e7eaec;padding-top: 10px;">
                        <label>&nbsp;关键词：</label>
                        <input type="text" name="keywords" class="form-control inline" style="width: 200px;" id="keywords" placeholder="请输入礼装名称" >&nbsp;                            
                        <a class="btn btn-success" onclick="doQuery();" ><i class="fa fa-search"></i>查询</a>
                        <a class="btn btn-primary" href="/admin.php/Mysticcode/Mysticcode_add"><i class="fa fa-plus"></i>添加</a>
                    </div>
                    <!--end 工具栏-->
                    <div class="ibox-content">
                        <!--表格-->
                        <table id="mcTable"></table>
                        <!--end 表格-->
                    </div>
                </div>
            </div>
        </div> 
    </div>   
    <script src="__HOME__/js/jquery.min.js"></script>
    <script src="__HOME__/js/bootstrap.min.js"></script>    
    <script src="__HOME__/js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
    <script src="__HOME__/js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
    <script src="__HOME__/js/plugins/layer/layer.min.js"></script>
    <script type="text/javascript">
        $(function () {
            initTable();
        });

        document.onkeydown = function (e) {
            e = e || event;
            if (e.keyCode == 13) { // 回车键
                doQuery();
            }
        };

        function initTable() {
            $('#mcTable').bootstrapTable({
                cache: false,
                toolbar: '#toolbar',
                url: "{:U('/admin.php/Mysticcode/mysticcode_list')}",
                height: $(window).height(),
                width: $(window).width(),
                uniqueId: "mysticcode_id", //每一行的唯一标识，一般为主键列
                silent: true,
                showRefresh: false,
                showColumns: false,
                queryParams: queryParams,
                columns: [
                    {
                        title: 'ID',
                        formatter: function (value, row, index) {
                            return index + 1;
                        }
                    }, {
                        field: 'name',
                        title: '名称'
                    }, {
                        field: 'thumb',
                        title: '缩略图',
                        formatter: function (value, row, index) {
                            return "<img src='" + value + "' width='100' height='100' />";
                        }
                    }, {
                        field: 'level',
                        title: '星级',
                        formatter: function (value, row, index) {
                            if (value == 1) {
                                return '⭐';
                            } else if (value == 2) {
                                return '⭐⭐';
                            } else if (value == 3) {
                                return '⭐⭐⭐';
                            } else if (value == 4) {
                                return '⭐⭐⭐⭐';
                            } else if (value == 5) {
                                return '⭐⭐⭐⭐⭐';
                            } else {
                                return '未知等级';
                            }
                        }
                    }, {
                        field: 'cost',
                        title: 'cost'
                    }, {
                        field: 'bas_hp',
                        title: '基础HP'
                    }, {
                        field: 'bas_atk',
                        title: '基础ATK'
                    }, {
                        field: 'max_hp',
                        title: '最大HP'
                    }, {
                        field: 'max_atk',
                        title: '最大ATK'
                    }, {
                        field: 'mysticcode_id',
                        title: '操作',
                        formatter: function (value, row, index) {
                            var btns = [];
                            btns.push("<a class='btn btn-warning btn-xs' href='/admin.php/Mysticcode/mysticcode_edit?id=" + value + "'>编辑</a>");
                            btns.push("<a class='btn btn-danger btn-xs' onclick='doDel(" + value + ")'>删除</a>");
                            btns.push("<a class='btn btn-success btn-xs' href='/admin.php/Mysticcode/mysticcode_detail?id=" + value + "'>详情</a>");
                            return btns.join(' &nbsp;');
                        }
                    }]
            });
        }

        // 请求参数
        function queryParams(params) {
            var param = {
                page_size: params.pageSize,
                cur_page: params.pageNumber,
                keywords: $('#keywords').val()
            };

            return param;
        }

        function doQuery() {
            $('#mcTable').bootstrapTable("refresh");
        }

    </script>
</body>
</html>